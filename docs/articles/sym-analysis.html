<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bmetr">
<title>Beethoven's symphonies analysis • bmetr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Beethoven's symphonies analysis">
<meta property="og:description" content="bmetr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bmetr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/metr-model.html">Beethoven's metronome from photographs</a>
    <a class="dropdown-item" href="../articles/sym-analysis.html">Beethoven's symphonies analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Enchufa2/bmetr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Beethoven's symphonies analysis</h1>
            <h3 data-toc-skip class="subtitle">from <a href="https://doi.org/10.1371/journal.pone.0243616" class="external-link"><em>Conductors’ tempo choices shed light over Beethoven’s metronome</em></a>
</h3>
                        <h4 data-toc-skip class="author">Almudena Martín-Castro, Iñaki Ucar</h4>
            
            <h4 data-toc-skip class="date">2020-12-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Enchufa2/bmetr/blob/HEAD/vignettes/sym-analysis.Rmd" class="external-link"><code>vignettes/sym-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>sym-analysis.Rmd</code></div>
    </div>

    
    
<p>This vignette presents an analysis of the performed tempo for 36 recordings, by 36 different conductors, of Beethoven’s symphonies (see <code><a href="../reference/sym.data.html">help(sym.data)</a></code>).</p>
<details><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Enchufa2/bmetr" class="external-link">bmetr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-quantities/errors" class="external-link">errors</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>errors.warn.bool<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span>, warn.conflicts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span>base_family<span class="op">=</span><span class="st">"sans"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="section level2">
<h2 id="data-set">Data set<a class="anchor" aria-label="anchor" href="#data-set"></a>
</h2>
<p>In this work, we selected 36 recordings of Beethoven’s complete symphonic works as performed by 36 different conductors, and classified them as Historically Informed (HI), under HI influence and Romantic, according to the analysis of L. D. Young (1991) and the performance reviews included with the recordings.</p>
<table class="table">
<caption>
<strong>List of recordings studied in this work</strong>. Each recording details the conductor’s name, orchestra, recording dates, label, Unique Product Code (UPC) and style.</caption>
<thead><tr class="header">
<th align="left">Conductor</th>
<th align="left">Dates</th>
<th align="left">Label</th>
<th align="left">UPC</th>
<th align="left">Style</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abbado, Claudio</td>
<td align="left">2000-2001</td>
<td align="left">DG</td>
<td align="left">028947758648</td>
<td align="left">HI influence</td>
</tr>
<tr class="even">
<td align="left">Barenboim, Daniel</td>
<td align="left">2011</td>
<td align="left">Decca</td>
<td align="left">028947835110</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Bernstein, Leonard</td>
<td align="left">1977-1979</td>
<td align="left">DG</td>
<td align="left">028947492429</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Böhm, Karl</td>
<td align="left">1969-1972</td>
<td align="left">DG</td>
<td align="left">028947919490</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Brüggen, Frans</td>
<td align="left">1984-1992</td>
<td align="left">Decca</td>
<td align="left">028947874362</td>
<td align="left">HI</td>
</tr>
<tr class="even">
<td align="left">Chailly, Riccardo</td>
<td align="left">2007-2009</td>
<td align="left">Decca</td>
<td align="left">028947834922</td>
<td align="left">HI influence</td>
</tr>
<tr class="odd">
<td align="left">Cluytens, André</td>
<td align="left">1957-1960</td>
<td align="left">Erato</td>
<td align="left">5099964830353</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Davis, Colin</td>
<td align="left">1995</td>
<td align="left">Philips</td>
<td align="left">028947568834</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Ferencsik, Janos</td>
<td align="left">1969-1976</td>
<td align="left">Hungaroton</td>
<td align="left">5991810401321</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Furtwängler, Wilhelm</td>
<td align="left">1947-1954</td>
<td align="left">Andromeda</td>
<td align="left">3830257490937</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Gardiner, John Eliot</td>
<td align="left">1991-1994</td>
<td align="left">DG</td>
<td align="left">028943990028</td>
<td align="left">HI</td>
</tr>
<tr class="even">
<td align="left">Gielen, Michael</td>
<td align="left">1997-2000</td>
<td align="left">Hänssler</td>
<td align="left">4010276025078</td>
<td align="left">HI influence</td>
</tr>
<tr class="odd">
<td align="left">Haitink, Bernard</td>
<td align="left">1985-1987</td>
<td align="left">Philips</td>
<td align="left">0028944207323</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Harnoncourt, Nikolaus</td>
<td align="left">1990-1991</td>
<td align="left">Teldec</td>
<td align="left">0809274976826</td>
<td align="left">HI influence</td>
</tr>
<tr class="odd">
<td align="left">Hickox, Richard</td>
<td align="left">1984-1988</td>
<td align="left">Resonance</td>
<td align="left">0680125050427</td>
<td align="left">HI influence</td>
</tr>
<tr class="even">
<td align="left">Hogwood, Christopher</td>
<td align="left">1985-1989</td>
<td align="left">Decca</td>
<td align="left">028945255125</td>
<td align="left">HI</td>
</tr>
<tr class="odd">
<td align="left">Hugget, M. and Goodman, R.</td>
<td align="left">1982-1988</td>
<td align="left">Nimbus</td>
<td align="left">0710357514425</td>
<td align="left">HI</td>
</tr>
<tr class="even">
<td align="left">Immerseel, Jos Van</td>
<td align="left">2005-2007</td>
<td align="left">Zigzag</td>
<td align="left">3700551732197</td>
<td align="left">HI</td>
</tr>
<tr class="odd">
<td align="left">Jochum, Eugen</td>
<td align="left">1967-1969</td>
<td align="left">Philips</td>
<td align="left">0028947581475</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Karajan, Herbert von</td>
<td align="left">1951-1955</td>
<td align="left">Warner Classics</td>
<td align="left">5099951586324</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Kegel, Herbert</td>
<td align="left">1982-1984</td>
<td align="left">Capriccio</td>
<td align="left">4006408500001</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Klemperer, Otto</td>
<td align="left">1960</td>
<td align="left">Music &amp; Arts</td>
<td align="left">0017685125225</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Leinsdorf, Erich</td>
<td align="left">1961-1969</td>
<td align="left">RCA</td>
<td align="left">0886919168228</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Masur, Kurt</td>
<td align="left">1972- 1975</td>
<td align="left">Philips</td>
<td align="left">0028947527220</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Mengelberg, Willem</td>
<td align="left">1940</td>
<td align="left">Archipel Records</td>
<td align="left">4035122401929</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Muti, Riccardo</td>
<td align="left">1985-1988</td>
<td align="left">Warner Classics</td>
<td align="left">5099909794627</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Norrington, Roger</td>
<td align="left">1987-1990</td>
<td align="left">Erato</td>
<td align="left">5099908342324</td>
<td align="left">HI</td>
</tr>
<tr class="even">
<td align="left">Pletnev, Mikhail</td>
<td align="left">2007</td>
<td align="left">DG</td>
<td align="left">0028947764090</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Polizzi, Antonino</td>
<td align="left">1986-1994</td>
<td align="left">Polymnie</td>
<td align="left">3576079901205</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Rattle, Simon</td>
<td align="left">2002</td>
<td align="left">EMI</td>
<td align="left">5099991562425</td>
<td align="left">HI influence</td>
</tr>
<tr class="odd">
<td align="left">Solti, Georg</td>
<td align="left">1986-1989</td>
<td align="left">Decca</td>
<td align="left">0028943040020</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Szell, George</td>
<td align="left">1956-1964</td>
<td align="left">Sony</td>
<td align="left">0888837371520</td>
<td align="left">Romantic</td>
</tr>
<tr class="odd">
<td align="left">Toscanini, Arturo</td>
<td align="left">1949-1952</td>
<td align="left">RCA</td>
<td align="left">0828765570220</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Tremblay, Jean-Philippe</td>
<td align="left">2009</td>
<td align="left">Analekta</td>
<td align="left">0774204997526</td>
<td align="left">HI influence</td>
</tr>
<tr class="odd">
<td align="left">Walter, Bruno</td>
<td align="left">1958-1959</td>
<td align="left">Sony</td>
<td align="left">5099750231227</td>
<td align="left">Romantic</td>
</tr>
<tr class="even">
<td align="left">Wand, Günter</td>
<td align="left">1985-1988</td>
<td align="left">RCA</td>
<td align="left">0743218910920</td>
<td align="left">Romantic</td>
</tr>
</tbody>
</table>
<p>The 9th Symphony is exceptional for various reasons. First, it was metronomized seven years later than the others using a different device, of which the date of purchase is not known. Second, its complexity, especially regarding the fourth movement, makes tempo extraction too unstable and unreliable. Finally, some authors have questioned the validity of the documental sources where these tempi were first published, only months before the composer’s death, due to multiple copy mistakes. For all these reasons, we decided to exclude it from the analysis. The rest of the data set comprises 1188 audio files (one symphonic movement per track), more than 169 hours of music.</p>
</div>
<div class="section level2">
<h2 id="tempo-extraction">Tempo extraction<a class="anchor" aria-label="anchor" href="#tempo-extraction"></a>
</h2>
<p>Audio files were sampled using a sliding window. Its duration was defined as a fraction of the track, so that the average width was 30 seconds, with a 90% overlap. In this way, each symphonic movement is divided in the same number of samples, regardless of the interpreter or the duration of the track. Every sample was then analyzed using a state-of-the-art tempo extraction algorithm by G. Percival et al. (2013, 2014) that bases pulse detection on self-similarity relations within the rhythm of a musical recording, and is implemented as part of the open-source framework <a href="https://github.com/marsyas/marsyas" class="external-link">Marsyas</a>.</p>
<p>This package contains all the auxiliary scripts used to extract tempo from the original recordings following this procedure (see the <code>scripts</code> folder). The result is the following data set:</p>
<details><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sym.window</span><span class="op">)</span></span></code></pre></div>
</details><pre><code><span><span class="co">##   symphony movement       conductor n     start  duration tempo</span></span>
<span><span class="co">## 1        1        1 Abbado, Claudio 0  0.000000 544.41796    96</span></span>
<span><span class="co">## 2        1        1 Abbado, Claudio 1  0.000000  30.24544   139</span></span>
<span><span class="co">## 3        1        1 Abbado, Claudio 2  3.024544  30.24544   172</span></span>
<span><span class="co">## 4        1        1 Abbado, Claudio 3  6.049088  30.24544   113</span></span>
<span><span class="co">## 5        1        1 Abbado, Claudio 4  9.073633  30.24544   153</span></span>
<span><span class="co">## 6        1        1 Abbado, Claudio 5 12.098177  30.24544   122</span></span></code></pre>
<div class="section level3">
<h3 id="first-steps">First steps<a class="anchor" aria-label="anchor" href="#first-steps"></a>
</h3>
<p>Sections containing a change of tempo or meter were identified and located on the score and the resulting samples. Different sections and movements were classified according to their meter (simple, duple or triple meter, with binary or ternary subdivision). This classification is important in order to identify the most probable tempo harmonics detected by the tempo extraction algorithm for each sample.</p>
<div class="figure">
<img src="harmonics.png" alt='**Most common tempo harmonics for each kind of meter**. The tempo extraction algorithm relies on periodic patterns and rhythmic self-similarities. This explains why many of its estimated tempi are actually multiples or submultiples of the real tempo of the sample. In this work, we have called these kinds of mistaken tempi "harmonics" due to the similarity with the homonym physical phenomenon. Their most common values depend on the metric structure of the music and are displayed here. More rarely, we also detected: (i) harmonics 2 y 3/4 in compound meters; (ii) harmonics 2 y 3/4 in meters with binary subdivision due to the occasional use of triplets; (iii) harmonic 2/3, in triple meters with binary subdivision.' width="600"><p class="caption">
<strong>Most common tempo harmonics for each kind of meter</strong>. The tempo extraction algorithm relies on periodic patterns and rhythmic self-similarities. This explains why many of its estimated tempi are actually multiples or submultiples of the real tempo of the sample. In this work, we have called these kinds of mistaken tempi “harmonics” due to the similarity with the homonym physical phenomenon. Their most common values depend on the metric structure of the music and are displayed here. More rarely, we also detected: (i) harmonics 2 y 3/4 in compound meters; (ii) harmonics 2 y 3/4 in meters with binary subdivision due to the occasional use of triplets; (iii) harmonic 2/3, in triple meters with binary subdivision.
</p>
</div>
<p>First, we annotate different section numbers based on the scores.</p>
<details><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">sym.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># filter out estimation for the complete movement</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># annotate sections</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>section <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">22</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">6</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">51</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">130</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">206</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">55</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">37</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">57</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">85</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">105</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">158</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">179</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">90</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">110</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">29</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">46</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">77</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">94</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">80</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">43</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">78</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">112</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">145</span><span class="op">)</span> <span class="op">|</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">174</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">9</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">110</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">165</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">236</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">9</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">43</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">70</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">113</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">130</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="fl">2</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">170</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">205</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="fl">3</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p>We filter out erroneous data and sections that are too short to give meaningful results.</p>
<details><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="co"># invalid tempo data</span></span>
<span>    <span class="va">tempo</span> <span class="op">!=</span> <span class="fl">0</span>,</span>
<span>    <span class="co"># 4th mvt. for symphonies 3 and 5, too fast and short</span></span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">section</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="co"># slow starts</span></span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    <span class="co"># 9th symphony, due to reasons above</span></span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">9</span><span class="op">)</span>,</span>
<span>    <span class="co"># very short section, irrelevant</span></span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="co"># issues in the audio file</span></span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Cluytens, André"</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">11</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><p>From the histograms of tempi, we calculate the most prominent tempo (peak of the histogram) per symphony, movement and section (<code>p.s</code>), the average duration (<code>avgdur</code>) and the most prominent tempo per symphony, movement, section and conductor (<code>p.sc</code>).</p>
<details><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># p.s = peak per section</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">section</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.s <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># exceptions checked by manual inspection</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span>, <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span>, <span class="va">p.s</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span><span class="op">]</span><span class="op">)</span>, <span class="va">p.s</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span>, <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">[</span><span class="fl">140</span><span class="op">:</span><span class="fl">175</span><span class="op">]</span><span class="op">)</span>, <span class="va">p.s</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>avgdur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># p.sc = peak per section and conductor</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">section</span>, <span class="va">conductor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sc <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># exceptions checked by manual inspection</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span>, <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span>, <span class="va">p.sc</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span>, <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span><span class="op">]</span><span class="op">)</span>, <span class="va">p.sc</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span>, <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">[</span><span class="fl">140</span><span class="op">:</span><span class="fl">175</span><span class="op">]</span><span class="op">)</span>, <span class="va">p.sc</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><p>Corrections to <code>p.s</code>:</p>
<details><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.s <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">|</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="va">p.s</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="va">p.s</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="va">p.s</span> <span class="op">/</span> <span class="fl">3</span>,</span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span></span>
<span>    <span class="op">~</span> <span class="va">p.s</span> <span class="op">/</span> <span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">p.s</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p>We calculate <code>p.sce</code> as an enhanced version of <code>p.sc</code> by various methods:</p>
<details><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># add annotations and define p.sce</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sym.marks</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symphony"</span>, <span class="st">"movement"</span>, <span class="st">"section"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="va">p.sc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># flag whether there's any repetition in each movement</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mov.rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">bar.rep</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># p.sd = p.s corrected with respect to the avgdur</span></span>
<span>  <span class="co"># it depends on whether there are repetitions in that movement</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sd <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="va">mov.rep</span>,</span>
<span>    <span class="va">p.s</span><span class="op">*</span><span class="va">avgdur</span><span class="op">/</span><span class="va">duration</span>,</span>
<span>    <span class="va">p.s</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">avgdur</span><span class="op">/</span><span class="va">duration</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">*</span><span class="op">(</span><span class="va">avgdur</span><span class="op">/</span><span class="va">duration</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># p.sce must be close to p.sd</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">conductor</span>, <span class="va">section</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify_tsig</a></span><span class="op">(</span><span class="va">p.sce</span>, <span class="va">p.sd</span>, <span class="va">tsig</span>, <span class="fl">0.18</span>, <span class="fl">0.187</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># additional corrections to p.sce</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">tsig</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">p.s</span><span class="op">&gt;</span><span class="fl">90</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Hogwood, Christopher"</span><span class="op">)</span></span>
<span>      <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">p.sce</span>, <span class="va">p.sd</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">0.13</span>, <span class="fl">0.114</span><span class="op">)</span>,</span>
<span>    <span class="va">tsig</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">p.s</span><span class="op">&lt;</span><span class="fl">90</span> <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">p.sce</span>, <span class="va">p.sd</span>, <span class="fl">2</span>, <span class="fl">0.12</span>, <span class="fl">0.185</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">p.sce</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">mov.rep</span>, <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify_tsig</a></span><span class="op">(</span><span class="va">p.sce</span>, <span class="va">p.s</span>, <span class="va">tsig</span>, <span class="fl">0.18</span>, <span class="fl">0.22</span><span class="op">)</span>, <span class="va">p.sce</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Rattle, Simon"</span> <span class="op">~</span> <span class="va">p.sc</span><span class="op">*</span><span class="fl">0.85</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">p.sce</span>, <span class="va">p.sd</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.144</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span> <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">p.sce</span>, <span class="va">p.sd</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    <span class="co"># exceptions checked by manual inspection</span></span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">p.sce</span><span class="op">&gt;</span><span class="fl">100</span> <span class="op">~</span> <span class="va">p.sce</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Furtwängler, Wilhelm"</span> <span class="op">~</span> <span class="va">p.sc</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Klemperer, Otto"</span> <span class="op">~</span> <span class="va">p.sc</span>,</span>
<span>    <span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Pletnev, Mikhail"</span> <span class="op">~</span> <span class="va">p.sc</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">p.sce</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># modify some p.sce due to general tempo variations</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">25</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">51</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Brüggen|Abbado|Hickox"</span>, <span class="va">conductor</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">n</span><span class="op">&lt;</span><span class="fl">70</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">129</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">140</span><span class="op">)</span> <span class="op">|</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">225</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span>  </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">190</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Tremblay, Jean-Philippe"</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">40</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">78</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Mengelberg, Willem"</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">49</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">78</span><span class="op">)</span> <span class="op">|</span>  </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">55</span><span class="op">)</span> </span>
<span>    <span class="op">~</span>  <span class="va">p.sce</span><span class="op">*</span><span class="fl">0.85</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">30</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">48</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Pletnev, Mikhail"</span><span class="op">)</span>  <span class="op">~</span> <span class="va">p.sce</span><span class="op">*</span><span class="fl">0.75</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">40</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">51</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Hickox, Richard"</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">27</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">46</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Harnoncourt, Nikolaus"</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">n</span><span class="op">&lt;</span><span class="fl">130</span> <span class="op">|</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">170</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Leinsdorf|Gardiner"</span>, <span class="va">conductor</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">150</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">40</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">71</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">!=</span><span class="st">"Furtwängler, Wilhelm"</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="va">p.sce</span><span class="op">*</span><span class="fl">0.9</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">85</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">135</span><span class="op">)</span>  <span class="op">~</span> <span class="va">p.sce</span><span class="op">*</span><span class="fl">1.15</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">34</span><span class="op">)</span> <span class="op">~</span> <span class="va">p.sce</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">n</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">p.sce</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="data-cleaning">Data cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>In the following, <code>p.sce</code> is used as a reference to find and rectify harmonics in the histogram within a certain tolerance. Tolerances are defined case per case to avoid harmonics getting mixed.</p>
<details><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we will take a representative example for 3 conductors</span></span>
<span><span class="va">example.filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quo</a></span><span class="op">(</span></span>
<span>  <span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Wand|Chailly|Immerseel"</span>, <span class="va">conductor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># raw tempo data, before any filtering</span></span>
<span><span class="va">example.window</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.window</span>, <span class="op">!</span><span class="op">!</span><span class="va">example.filter</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">conductor</span>, <span class="va">section</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># harmonics 3 and 1/3 (extreme cases)</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify_tsig</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="va">tsig</span>, <span class="fl">0.14</span>, <span class="fl">0.17</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">3</span>, <span class="fl">0.19</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">0.5</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span></span>
<span>  <span class="co"># typical harmonics by time signature</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>     <span class="va">tsig</span><span class="op">!=</span><span class="fl">3</span>  <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">2</span>, <span class="fl">0.18</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>     <span class="va">tsig</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">p.s</span><span class="op">&lt;</span><span class="fl">90</span> <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">2</span>, <span class="fl">0.133</span>, <span class="fl">0.15</span><span class="op">)</span>, </span>
<span>     <span class="va">tsig</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">p.s</span><span class="op">&gt;</span><span class="fl">90</span> <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">0.13</span>, <span class="fl">0.12</span><span class="op">)</span>,</span>
<span>     <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">tempo</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># harmonic 3/2</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">36</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">80</span><span class="op">)</span> <span class="op">|</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">110</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span>                   <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span>      <span class="co"># tsig 0.3</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">66</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">130</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">175</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">230</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">!=</span><span class="fl">3</span><span class="op">)</span> <span class="op">|</span>      <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span>                   <span class="co"># tsig 0.3</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>  <span class="op">|</span>                  <span class="co"># tsig 0.3</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span>      <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">44</span> <span class="op">&amp;</span> <span class="va">n</span> <span class="op">&lt;</span><span class="fl">84</span><span class="op">)</span> <span class="op">|</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">133</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">65</span><span class="op">)</span> <span class="op">|</span>            <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">38</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">81</span><span class="op">)</span> <span class="op">|</span>     <span class="co"># tsig 0.3</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span>                     <span class="co"># tsig 2</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0.12</span>, <span class="fl">0.14</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">tempo</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># harmonic 2/3</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">tsig</span><span class="op">==</span><span class="fl">0.3</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span>                 <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span>                 <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>                   <span class="co"># tsig 2</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">0.12</span>, <span class="fl">0.115</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">tempo</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># harmonics 2, 1/2, 4/3</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="op">|</span>                <span class="co"># tsig 2</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span>   <span class="co"># tsig 2</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.21</span><span class="op">)</span>,</span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="st">"1"</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="st">"1"</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">conductor</span> <span class="op">!=</span><span class="st">"Pletnev, Mikhail"</span><span class="op">)</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">4</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span>, </span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">100</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">15</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">6</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">5</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">section</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> </span>
<span>    <span class="op">~</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_rectify</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">tempo</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tempo data after harmonic correction</span></span>
<span><span class="va">example.window</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">example.window</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.window</span>, <span class="op">!</span><span class="op">!</span><span class="va">example.filter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p>Then, tempo values are corrected using a continuity criterion. In a typical recording, tempo can vary a lot, so the harmonics correction based on the histogram peak might sometimes fail. In those cases we can take advantage of the fact that tempo usually varies smoothly: each data point is compared with the previous 3 samples in search for the same harmonic relationships as in the previous step, and corrected appropriately if found. Finally, outliers, defined as data points that differ more than 2 standard deviations from the corrected peak, are removed and replaced by interpolated values.</p>
<details><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">conductor</span>, <span class="va">section</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># continuity based on time signature</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_smooth</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="va">tsig</span>, <span class="fl">0.12</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span></span>
<span>  <span class="co"># special cases harmonic 3</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Mengelberg, Willem"</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">53</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>      <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Jochum, Eugen"</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">109</span> <span class="op">&amp;</span> <span class="va">n</span> <span class="op">&lt;</span><span class="fl">121</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>      <span class="op">!</span><span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">3</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">conductor</span><span class="op">==</span><span class="st">"Wand, Günter"</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">155</span> <span class="op">&amp;</span> <span class="va">n</span> <span class="op">&lt;</span><span class="fl">165</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/tmp_rectify.html">tmp_smooth</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">3</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span><span class="op">)</span>, <span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># special cases harmonic 2/3</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">8</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/tmp_rectify.html">tmp_smooth</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="fl">0.95</span><span class="op">*</span><span class="va">p.sce</span>, <span class="fl">0</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># special cases harmonic 3/4</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>    <span class="va">tsig</span><span class="op">==</span><span class="fl">3</span> <span class="op">|</span> <span class="op">(</span><span class="va">symphony</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">movement</span><span class="op">==</span><span class="fl">2</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">5</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">&lt;</span><span class="fl">87</span><span class="op">)</span> <span class="op">|</span> <span class="va">n</span><span class="op">&gt;</span><span class="fl">110</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/tmp_rectify.html">tmp_smooth</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="va">p.sce</span>, <span class="fl">0</span>, <span class="fl">0.12</span>, <span class="fl">0.12</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>, <span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># remove outliers and interpolate</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">tempo</span> <span class="op">&gt;</span> <span class="va">p.sce</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">sd</span>, <span class="cn">NA_real_</span>, <span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">tempo</span> <span class="op">&lt;</span> <span class="va">p.sce</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">sd</span>, <span class="cn">NA_real_</span>, <span class="va">tempo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu">zoo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">na.approx</a></span><span class="op">(</span><span class="va">tempo</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># recalculation of p.s and p.sce</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">section</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.s <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">symphony</span>, <span class="va">movement</span>, <span class="va">conductor</span>, <span class="va">section</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>p.sce <span class="op">=</span> <span class="fu"><a href="../reference/tmp_rectify.html">tmp_prevalent</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tempo data after continuity correction</span></span>
<span><span class="va">example.window</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">example.window</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.window</span>, <span class="op">!</span><span class="op">!</span><span class="va">example.filter</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p>These are the results of this data cleaning process:</p>
<details><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example.window</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">example.window</span>, .id<span class="op">=</span><span class="st">"stage"</span><span class="op">)</span></span>
<span><span class="va">notes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  mark <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">example.window</span><span class="op">$</span><span class="va">mark</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Beethoven's mark"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">" x3/2"</span>, <span class="st">" x3"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  vjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.6</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">120</span>, <span class="fl">160</span><span class="op">)</span></span>
<span><span class="va">expand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">balpha</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">example.window</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">tempo</span>, color<span class="op">=</span><span class="va">conductor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html" class="external-link">geom_rangeframe</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">mark</span><span class="op">)</span>, <span class="va">notes</span>, alpha<span class="op">=</span><span class="va">balpha</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="st">"stage"</span>, scales<span class="op">=</span><span class="st">"free_y"</span>, space<span class="op">=</span><span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">expand</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">breaks</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Tempo [bpm]"</span>, x<span class="op">=</span><span class="st">"Sample"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">example.window</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">tempo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html" class="external-link">expand_limits</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">expand</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="st">"stage"</span>, scales<span class="op">=</span><span class="st">"free_y"</span>, space<span class="op">=</span><span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">stat_bin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">conductor</span><span class="op">)</span>, <span class="st">","</span><span class="op">)</span>, <span class="st">"["</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           position<span class="op">=</span><span class="st">"identity"</span>, alpha<span class="op">=</span><span class="fl">.7</span>, binwidth<span class="op">=</span><span class="fl">1</span>, boundary<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">mark</span><span class="op">)</span>, <span class="va">notes</span>, alpha<span class="op">=</span><span class="va">balpha</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mark</span>, <span class="fl">0.32</span>, label<span class="op">=</span><span class="va">label</span>, vjust<span class="op">=</span><span class="va">vjust</span><span class="op">)</span>, <span class="va">notes</span>,</span>
<span>            hjust<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="va">balpha</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">breaks</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"Conductor"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="cn">FALSE</span>, fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span>, override.aes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.85</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.key.size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"pt"</span><span class="op">)</span>, legend.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>        legend.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>, strip.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">h</span>, nrow<span class="op">=</span><span class="fl">1</span>, widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<img src="sym-analysis_files/figure-html/unnamed-chunk-12-1.png" alt="**Tempo data from symphonic recordings**. **a,** Representative example of raw data from the tempo extraction algorithm for 3 different conductors performing the 1st movement of the 3rd Symphony. Although the time series seem noisy on first sight, the histogram in the right panel shows a clear pattern: the algorithm not only detects the true tempo (components right below Beethoven's mark), but also multiples (or harmonics) of this frequency (in this example, x3/2 and x3). **b,** Using Beethoven's mark as a reference, harmonics in the raw data are found and rectified. **c,** A final smoothing ensures consistency in terms of continuity throughout contiguous samples." width="700"><p class="caption">
<strong>Tempo data from symphonic recordings</strong>. <strong>a,</strong> Representative example of raw data from the tempo extraction algorithm for 3 different conductors performing the 1st movement of the 3rd Symphony. Although the time series seem noisy on first sight, the histogram in the right panel shows a clear pattern: the algorithm not only detects the true tempo (components right below Beethoven’s mark), but also multiples (or harmonics) of this frequency (in this example, x3/2 and x3). <strong>b,</strong> Using Beethoven’s mark as a reference, harmonics in the raw data are found and rectified. <strong>c,</strong> A final smoothing ensures consistency in terms of continuity throughout contiguous samples.
</p>
</div>
<p>The top panel shows a representative example of raw data from the tempo extraction algorithm for 3 different conductors performing the 1st movement of the 3rd Symphony. Although the time series seem noisy on first sight, the histogram in the right panel shows a clear pattern: due to the rhythmic complexity of Beethoven’s music, the algorithm not only detects the true tempo (components right below Beethoven’s mark), but also multiples (or harmonics) of this frequency (in this example, x3/2 and x3). Using Beethoven’s mark as a reference for the “true tempo”, harmonics in the raw data are found and rectified (central panel). The final smoothing ensures consistency in terms of continuity throughout contiguous samples (bottom panel).</p>
</div>
<div class="section level3">
<h3 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h3>
<p>A complementary methodology was developed to assess the validity of this collection of tempo measurements. We sampled 30 seconds from the last minute of every movement, thus compiling a set of finales, where tempo is arguably more stable (see <code>help(sym.sample</code>). Tempo was also extracted using Marsyas on first pass, but then carefully curated by hand. The main data set is validated by comparing the median tempo for each conductor and mark with the median tempo as obtained from this data set of finales.</p>
<details><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.sample</span> <span class="op">&lt;-</span> <span class="va">sym.sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sym.marks</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"symphony"</span>, <span class="st">"movement"</span>, <span class="st">"section"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dt.val.conductor</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">conductor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">tempo</span> <span class="op">-</span> <span class="va">mark</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="va">dt.sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">conductor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">tempo</span> <span class="op">-</span> <span class="va">mark</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sym.recordings</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">]</span>, by<span class="op">=</span><span class="st">"conductor"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ptype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">ptype</span>, <span class="st">"Romantic"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt.val.conductor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">window</span>, <span class="va">sample</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html" class="external-link">geom_rangeframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">ptype</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggpmisc</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_poly_eq.html" class="external-link">stat_poly_eq</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, parse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dt.val.conductor</span><span class="op">$</span><span class="va">ptype</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Main data set"</span>, y<span class="op">=</span><span class="st">"Validation data set"</span>, color<span class="op">=</span><span class="st">"Performance"</span>,</span>
<span>       subtitle<span class="op">=</span><span class="st">"Median tempo difference by conductor [bpm]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dt.val.mark</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">mark</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">tempo</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="va">dt.sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">mark</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">tempo</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt.val.mark</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">window</span>, <span class="va">sample</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html" class="external-link">geom_rangeframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggpmisc</span><span class="fu">::</span><span class="fu"><a href="https://docs.r4photobiology.info/ggpmisc/reference/stat_poly_eq.html" class="external-link">stat_poly_eq</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, parse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Main data set"</span>, y<span class="op">=</span><span class="st">"Validation data set"</span>, color<span class="op">=</span><span class="st">"Performance"</span>,</span>
<span>       subtitle<span class="op">=</span><span class="st">"Median tempo by mark [bpm]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<img src="sym-analysis_files/figure-html/unnamed-chunk-13-1.png" alt="**Validation of tempo data**. **a,** Each dot represents a conductor, and compares the median tempo difference (tempo choice minus Beethoven's mark) for the main and validation data sets. **b,** Each dot represents a metronome mark, and compares the median tempo for the main and validation data sets. Both figures show a 1:1 relation, which ensures the consistency of the main data set." width="50%"><img src="sym-analysis_files/figure-html/unnamed-chunk-13-2.png" alt="**Validation of tempo data**. **a,** Each dot represents a conductor, and compares the median tempo difference (tempo choice minus Beethoven's mark) for the main and validation data sets. **b,** Each dot represents a metronome mark, and compares the median tempo for the main and validation data sets. Both figures show a 1:1 relation, which ensures the consistency of the main data set." width="50%"><p class="caption">
<strong>Validation of tempo data</strong>. <strong>a,</strong> Each dot represents a conductor, and compares the median tempo difference (tempo choice minus Beethoven’s mark) for the main and validation data sets. <strong>b,</strong> Each dot represents a metronome mark, and compares the median tempo for the main and validation data sets. Both figures show a 1:1 relation, which ensures the consistency of the main data set.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="by-conductor">By conductor<a class="anchor" aria-label="anchor" href="#by-conductor"></a>
</h3>
<p>After this process, we obtained a very accurate description of the performed tempi of Beethoven’s symphonies, which supports previous qualitative analyses. Overall, performed tempi are always slower than Beethoven’s marks on average, but the influence of the HI movement is evident: attending to the median of their distribution, 12 out of the 15 fastest interpretations correspond to HI or HI-influenced performers.</p>
<details><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sym.recordings</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">]</span>, by<span class="op">=</span><span class="st">"conductor"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>conductor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">conductor</span>, <span class="va">tempo</span> <span class="op">-</span> <span class="va">mark</span>, <span class="va">median</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ptype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">ptype</span>, <span class="st">"Romantic"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">tempo</span> <span class="op">-</span> <span class="va">mark</span>, <span class="va">conductor</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggridges</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html" class="external-link">geom_density_ridges</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">ptype</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"lightgray"</span>, size<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>    quantile_lines<span class="op">=</span><span class="cn">TRUE</span>, quantiles<span class="op">=</span><span class="fl">2</span>, vline_color<span class="op">=</span><span class="st">"white"</span>, vline_size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dt.window</span><span class="op">$</span><span class="va">ptype</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"right"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">40</span>, <span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="cn">NULL</span>, x<span class="op">=</span><span class="st">"Tempo difference [bpm]"</span>, fill<span class="op">=</span><span class="st">"Performance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.97</span>, <span class="fl">0.03</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, </span>
<span>        legend.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span>, </span>
<span>        axis.ticks.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        panel.grid.major.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgray"</span>, size<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<img src="sym-analysis_files/figure-html/unnamed-chunk-14-1.png" alt="**Tempo data from symphonic recordings**. Distribution of tempo difference between conductors' tempo choices and Beethoven's marks. K. Böhm, at the bottom of the list, is well known among critics as one of the slowest performers of Beethoven. On the other end, R. Chailly is the conductor who comes closer to the composer's indications as he reportedly intended. But even he falls slightly behind Beethoven's marks on average, a circumstance that has been even praised by some critics. Remarkably, M. Pletnev has the most extreme and sparse distribution, reaching tempi far below and above other conductors. In fact, critics consider him an artist of contrasts, unorthodox and unpredictable." width="700"><p class="caption">
<strong>Tempo data from symphonic recordings</strong>. Distribution of tempo difference between conductors’ tempo choices and Beethoven’s marks. K. Böhm, at the bottom of the list, is well known among critics as one of the slowest performers of Beethoven. On the other end, R. Chailly is the conductor who comes closer to the composer’s indications as he reportedly intended. But even he falls slightly behind Beethoven’s marks on average, a circumstance that has been even praised by some critics. Remarkably, M. Pletnev has the most extreme and sparse distribution, reaching tempi far below and above other conductors. In fact, critics consider him an artist of contrasts, unorthodox and unpredictable.
</p>
</div>
<p>Karl Böhm, at the bottom of the list, is well known among critics as one of the slowest performers of Beethoven, sometimes even characterized as “stiff” (see <a href="https://www.classicstoday.com/review/review-6697" class="external-link">Carr</a>). On the other end, Riccardo Chailly is the conductor who comes closer to the composer’s indications as he reportedly intended. But even he falls slightly behind Beethoven’s marks. Some critics have even praised this apparent failure. According to <a href="https://www.gramophone.co.uk/review/beethoven-symphonies" class="external-link">Richard Osborne</a>, “happily Chailly is too good a musician to put into practice his reported assertion that he performs everything at ‘precisely Beethoven’s metronome mark’”. Mikhail Pletnev constitutes a remarkable exception, being at times faster than HI performers but also slower than any other Romantic conductor. Although he generally rejects HI criteria, critics consider him an artist of contrasts, unorthodox and unpredictable. As <a href="https://www.gramophone.co.uk/review/beethoven-symphonies-1" class="external-link">Osborne put it</a>, “For every movement conducted by Dr Jekyll there is another just around the corner awaiting its fate at the hands of Mr Hyde.”</p>
</div>
<div class="section level3">
<h3 id="by-mark">By mark<a class="anchor" aria-label="anchor" href="#by-mark"></a>
</h3>
<p>Performed tempo is modelled as a function of the metronome marks by means of a mixed-effects linear model, using the intercept as a random effect for each conducting style.</p>
<details><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.medians</span> <span class="op">&lt;-</span> <span class="va">dt.window</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ptype</span>, <span class="va">mark</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>tempo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">tempo</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># all groups agree on this mark, as we'll see</span></span>
<span><span class="va">dt.exception</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.medians</span>, <span class="va">mark</span> <span class="op">==</span> <span class="fl">72</span><span class="op">)</span></span>
<span><span class="va">dt.medians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.medians</span>, <span class="va">mark</span> <span class="op">!=</span> <span class="fl">72</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">tempo</span> <span class="op">~</span> <span class="va">mark</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">ptype</span><span class="op">)</span>, <span class="va">dt.medians</span><span class="op">)</span></span>
<span></span>
<span><span class="va">re</span> <span class="op">&lt;-</span> <span class="fu">merTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/merTools/man/REsim.html" class="external-link">REsim</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">re</span><span class="op">)</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"mean.se"</span></span>
<span><span class="va">re</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/errors.html">unite_errors</a></span><span class="op">(</span><span class="va">re</span><span class="op">)</span></span>
<span><span class="va">re</span><span class="op">$</span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">re</span><span class="op">$</span><span class="va">mean</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">re</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, caption<span class="op">=</span><span class="va">table2</span><span class="op">)</span></span></code></pre></div>
</details><table class="table">
<caption>
<strong>Average slow-down estimation</strong> for each stylistic group.</caption>
<thead><tr class="header">
<th align="left">groupFctr</th>
<th align="left">groupID</th>
<th align="left">term</th>
<th align="right">mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ptype</td>
<td align="left">HI</td>
<td align="left">(Intercept)</td>
<td align="right">-6(2)</td>
</tr>
<tr class="even">
<td align="left">ptype</td>
<td align="left">HI influence</td>
<td align="left">(Intercept)</td>
<td align="right">-8(2)</td>
</tr>
<tr class="odd">
<td align="left">ptype</td>
<td align="left">Romantic</td>
<td align="left">(Intercept)</td>
<td align="right">-13(2)</td>
</tr>
</tbody>
</table>
<details><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.medians</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">dt.medians</span>, <span class="fu">merTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/merTools/man/predictInterval.html" class="external-link">predictInterval</a></span><span class="op">(</span><span class="va">fit</span>, level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/r2.html" class="external-link">r2</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"atop(\"Conditional \"~italic(R)^2~`=`~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="st">",~~~~\"Marginal\"~italic(R)^2~`=`~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mark<span class="op">=</span><span class="fl">150</span>, tempo<span class="op">=</span><span class="fl">40</span>, ptype<span class="op">=</span><span class="st">"Romantic"</span>, label<span class="op">=</span><span class="va">r2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt.medians</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mark</span>, <span class="va">tempo</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">ptype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html" class="external-link">geom_rangeframe</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="va">mark</span><span class="op">)</span>, <span class="va">dt.window</span>, scale<span class="op">=</span><span class="st">"width"</span>, color<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dt.exception</span>, shape<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lwr</span>, ymax<span class="op">=</span><span class="va">upr</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">fit</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">label</span><span class="op">)</span>, <span class="va">perf</span>, hjust<span class="op">=</span><span class="fl">1</span>, parse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Metronome mark [bpm]"</span>, y<span class="op">=</span><span class="st">"Performed tempo [bpm]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<img src="sym-analysis_files/figure-html/unnamed-chunk-16-1.png" alt="**Performed tempo by stylistic criterion vs. Beethoven's marks**. Each panel shows the distribution of tempo choices for each mark. The median for each distribution is shown as a dot, and the grayed line represents the 1:1 relation. On top of that, a mixed-effects regression line (in blue) for the medians, with a 95% Confidence Interval (CI), quantifies the effect of each group of conductors: all the marks are reduced on average by a fixed amount along the whole metronome range, preserving the relative discrepancy between groups. Interestingly, 72 bpm (7th Symphony, 4th movement; represented by an empty dot) seems to be the only mark that all groups accept as accurate, and therefore it was excluded from the regression model." width="100%"><p class="caption">
<strong>Performed tempo by stylistic criterion vs. Beethoven’s marks</strong>. Each panel shows the distribution of tempo choices for each mark. The median for each distribution is shown as a dot, and the grayed line represents the 1:1 relation. On top of that, a mixed-effects regression line (in blue) for the medians, with a 95% Confidence Interval (CI), quantifies the effect of each group of conductors: all the marks are reduced on average by a fixed amount along the whole metronome range, preserving the relative discrepancy between groups. Interestingly, 72 bpm (7th Symphony, 4th movement; represented by an empty dot) seems to be the only mark that all groups accept as accurate, and therefore it was excluded from the regression model.
</p>
</div>
<p>This model reveals a common trend shared by all groups: a 1:1 relationship with the marks (95% CI [0.95, 1.03]), and a significative random effect (LRT = 15.29, p &lt; .001), which suggests that performers slow down Beethoven’s marks, on average, by a fixed amount that is different for each group of conductors.</p>
</div>
<div class="section level3">
<h3 id="metronome-distortions">Metronome distortions<a class="anchor" aria-label="anchor" href="#metronome-distortions"></a>
</h3>
<p>Hereafter, we consider the average discrepancy measured by this model for Romantic conductors as a proxy for Beethoven’s intended tempo. Thus, we are interested in comparing these results with possible distortions that decrease the metronome’s frequency by a comparable amount throughout all its range, without remarkable defects or anomalous behaviors that could warn Beethoven about a flaw in the device.</p>
<details><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt.window.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.window</span>, <span class="va">ptype</span><span class="op">==</span><span class="st">"Romantic"</span><span class="op">)</span></span>
<span><span class="va">dt.medians.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.medians</span>, <span class="va">ptype</span><span class="op">==</span><span class="st">"Romantic"</span><span class="op">)</span></span>
<span><span class="va">dt.exception.r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dt.exception</span>, <span class="va">ptype</span><span class="op">==</span><span class="st">"Romantic"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Beethoven's metronome parameters</span></span>
<span><span class="va">M.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html" class="external-link">set_errors</a></span><span class="op">(</span><span class="fl">4.008046</span>, <span class="fl">0.1068220</span><span class="op">)</span></span>
<span><span class="va">mu.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html" class="external-link">set_errors</a></span><span class="op">(</span><span class="fl">0.6387369</span>, <span class="fl">0.02924174</span><span class="op">)</span></span>
<span><span class="va">metr.params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Patent"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/errors.html">unite_errors</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt.medians.r</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mark</span>, <span class="va">tempo</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html" class="external-link">geom_rangeframe</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">fit</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">fit</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Metronome mark [bpm]"</span>, y<span class="op">=</span><span class="st">"Performed tempo [bpm]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="fl">1</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p>We analyzed the possible variation of the lower mass M and its distance to the shaft R resulting from some possible blow that could have broken or loosen it up, as proposed by Forsén et al. (2013). However, these are similar distortions that mostly affect the slower frequencies. We also considered different inclinations of the metronome, maybe held in an unstable position on the piano while rehearsing. This affects the gravitational acceleration experimented by the pendulum, but would have caused the quicker frequencies to decelerate mostly and, more importantly, would only be noticeable for extremely sharp inclinations.</p>
<details><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">8</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"Variation of R [mm]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">R</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">R</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">R</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="op">-</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">15</span><span class="op">)</span>, name<span class="op">=</span><span class="st">"Variation of M [%]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">M.</span>, <span class="va">M.</span><span class="op">-</span><span class="fl">0.05</span><span class="op">*</span><span class="va">M.</span><span class="op">)</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">M.</span>, <span class="va">M.</span><span class="op">-</span><span class="fl">0.10</span><span class="op">*</span><span class="va">M.</span><span class="op">)</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">M.</span>, <span class="va">M.</span><span class="op">-</span><span class="fl">0.15</span><span class="op">*</span><span class="va">M.</span><span class="op">)</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="op">-</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, trans<span class="op">=</span><span class="st">"reverse"</span>, name<span class="op">=</span><span class="st">"Variation of inclination [°]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span>, g<span class="op">=</span><span class="fl">9.807</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span>, g<span class="op">=</span><span class="fl">9.807</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">25</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span>, g<span class="op">=</span><span class="fl">9.807</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">40</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<img src="sym-analysis_files/figure-html/unnamed-chunk-18-1.png" alt="**Effect of different metronome distortions on its frequency compared to the average slow-down of Romantic conductors**. **a,** Reduction of the distance of the lower mass to the shaft, $R$. **b,** Reduction of the lower mass, $M$. **c,** Inclination of the metronome." width="100%"><p class="caption">
<strong>Effect of different metronome distortions on its frequency compared to the average slow-down of Romantic conductors</strong>. <strong>a,</strong> Reduction of the distance of the lower mass to the shaft, <span class="math inline">\(R\)</span>. <strong>b,</strong> Reduction of the lower mass, <span class="math inline">\(M\)</span>. <strong>c,</strong> Inclination of the metronome.
</p>
</div>
<p>Finally, a shift of the moving weight relative to the scale is the only mechanism that describes the observed slow-down of tempo by performers, which in turn can be explained by the user reading the marks below the moving weight.</p>
<details><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">16</span><span class="op">)</span>, trans<span class="op">=</span><span class="st">"reverse"</span>, name<span class="op">=</span><span class="st">"Scale shift [mm]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span>, shift<span class="op">=</span><span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span>, shift<span class="op">=</span><span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">metr_model_bias</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    R<span class="op">=</span><span class="va">R</span>, M.<span class="op">=</span><span class="va">M.</span>, l<span class="op">=</span><span class="va">l</span>, mu.<span class="op">=</span><span class="va">mu.</span>, A<span class="op">=</span><span class="va">A</span>, shift<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<img src="sym-analysis_files/figure-html/unnamed-chunk-19-1.png" alt="**Effect of different metronome distortions on its frequency compared to the average slow-down of Romantic conductors**. **d,** Displacement of the scale relative to the moving weight." width="700"><p class="caption">
<strong>Effect of different metronome distortions on its frequency compared to the average slow-down of Romantic conductors</strong>. <strong>d,</strong> Displacement of the scale relative to the moving weight.
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Almudena Martín-Castro, Iñaki Ucar.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
