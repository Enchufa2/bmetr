<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beethoven's metronome from photographs • bmetr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Beethoven's metronome from photographs">
<meta property="og:description" content="bmetr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bmetr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/metr-model.html">Beethoven's metronome from photographs</a>
    </li>
    <li>
      <a href="../articles/sym-analysis.html">Beethoven's symphonies analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Enchufa2/bmetr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="metr-model_files/header-attrs-2.5/header-attrs.js"></script><script src="metr-model_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="metr-model_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="metr-model_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Beethoven’s metronome from photographs</h1>
            <h3 class="subtitle">from <a href="https://doi.org/10.1371/journal.pone.0243616"><em>Conductors’ tempo choices shed light over Beethoven’s metronome</em></a>
</h3>
                        <h4 class="author">Almudena Martín-Castro, Iñaki Ucar</h4>
            
            <h4 class="date">2020-12-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Enchufa2/bmetr/blob/master/vignettes/metr-model.Rmd"><code>vignettes/metr-model.Rmd</code></a></small>
      <div class="hidden name"><code>metr-model.Rmd</code></div>

    </div>

    
    
<p>This vignette discusses and validates a mathematical model using experimental measurements from a contemporary metronome (see <code><a href="../reference/metr.data.html">help(metr.data)</a></code>). Then, we fit the metronome model for several metronomes to obtain their nondimensionalized masses, and finally, we characterize Beethoven’s metronome.</p>
<details><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Enchufa2/bmetr">bmetr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-quantities/errors">errors</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>errors.warn.coercion<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_tufte.html">theme_tufte</a></span><span class="op">(</span>base_family<span class="op">=</span><span class="st">"sans"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><div class="figure">
<img src="metronomes.jpg" alt="**Mechanical metronomes.** From left to right, a contemporary Neewer© NW-707, TB 06, TB 07 (both from Tony Bingham's _Metronomes and Musical Time_), Maelzel's patent, and a diagram depicting the main parameters of the model." width="100%"><p class="caption">
<strong>Mechanical metronomes.</strong> From left to right, a contemporary Neewer© NW-707, TB 06, TB 07 (both from Tony Bingham’s <em>Metronomes and Musical Time</em>), Maelzel’s patent, and a diagram depicting the main parameters of the model.
</p>
</div>
<div id="the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#the-model" class="anchor"></a>The model</h1>
<p>Contemporary mechanical metronomes preserve essentially the same design as Maelzel’s metronome. The angular frequency of oscillation, <span class="math inline">\(\Omega\)</span>, is obtained as a function of three multiplicative terms:</p>
<p><span class="math display">\[
\Omega = f_\mathrm{ang}^{-1}(\theta)\cdot f_\mathrm{fric}^{-1}(\epsilon)\cdot \sqrt[]{g\frac{M'R -\frac{\mu'}{2} (l-L) -r}{M'R^2 + \frac{\mu'}{3} ( L^2 + l^2- lL) + r^2}}
\]</span></p>
<p>where the last term draws from the classical expression for an ideal double pendulum, but includes corrections to account for the effect in the moment of inertia of the non-negligible mass, <span class="math inline">\(\mu\)</span>, of the rod. Other parameters are the gravitational acceleration (<span class="math inline">\(g\)</span>), the nondimensionalized lower (<span class="math inline">\(M' = M / m\)</span>) and rod (<span class="math inline">\(μ' = μ / m\)</span>) masses, the distances of the lower and upper masses to the shaft (<span class="math inline">\(R\)</span> and <span class="math inline">\(r\)</span>, respectively), and the length of the two ends of the rod from the shaft (<span class="math inline">\(L\)</span> and <span class="math inline">\(l\)</span>, respectively). The first two terms, <span class="math inline">\(f_\mathrm{ang}\)</span> and <span class="math inline">\(f_\mathrm{fric}\)</span>, are further corrections to account, respectively, for large oscillations (usually ranging from <span class="math inline">\(θ = 40°\)</span> to <span class="math inline">\(60°\)</span>) and friction and impulse forces:</p>
<p><span class="math display">\[
f_\mathrm{ang} (\theta)= 1 + \sum_{n=1}^\infty\left[ \frac{(2n-1)!!}{(2n)!!}\sin^{2n}\left( \frac{\theta}{2} \right) \right]^2\\
f_\mathrm{fric} (\epsilon)= 1 + \frac{1}{\pi}\sin^{-1}\left(\frac{\epsilon}{1-\epsilon}\right) - \frac{1}{\pi} \sin^{-1}\left(\frac{\epsilon}{1+\epsilon}\right)
\]</span></p>
<p>where <span class="math inline">\(\epsilon = \frac{\tau_\mathrm{roz}}{\Omega^2 I \theta}\)</span> is a nondimensional parameter that must range from <span class="math inline">\(0 \leq \epsilon \leq 0.5\)</span>, so that the equation has a real solution. It is proportional to the friction torque <span class="math inline">\(\tau\)</span>, and inversely proportional to the angular frequency squared and the moment of inertia.</p>
<div id="measurements" class="section level2">
<h2 class="hasAnchor">
<a href="#measurements" class="anchor"></a>Measurements</h2>
<p>A contemporary metronome was used to validate the model. First, the angular frequency for each metronome mark was measured by means of extracting the tickling period over 15-second audio samples. This package contains a sample file with the audio recorded for 100 bpm. These are the steps to measure the frequency:</p>
<ol style="list-style-type: decimal">
<li>Normalize and square the signal.</li>
<li>Remove noise (just zeroing values under 0.5).</li>
<li>Find peaks with a sensitivity of 50 ms (see <code><a href="../reference/find_peaks.html">help(find_peaks)</a></code>).</li>
<li>Compute the differences (in samples) and transform.</li>
</ol>
<p>With the sample file:</p>
<details><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f.raw</span> <span class="op">&lt;-</span> <span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html">readWave</a></span><span class="op">(</span><span class="st">"100.wav"</span><span class="op">)</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/normalize.html">normalize</a></span><span class="op">(</span><span class="va">f.raw</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="va">f</span><span class="op">@</span><span class="va">left</span><span class="op">[</span><span class="va">f</span><span class="op">@</span><span class="va">left</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_peaks.html">find_peaks</a></span><span class="op">(</span><span class="va">f</span><span class="op">@</span><span class="va">left</span>, <span class="va">f</span><span class="op">@</span><span class="va">samp.rate</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="fu">tuneR</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">f.raw</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">peaks</span><span class="op">/</span><span class="va">f</span><span class="op">@</span><span class="va">samp.rate</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">f.raw</span><span class="op">@</span><span class="va">left</span><span class="op">[</span><span class="va">peaks</span><span class="op">]</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></code></pre></div>
</details><div class="figure">
<img src="metr-model_files/figure-html/unnamed-chunk-3-1.png" alt="**Peak detection in sample file**." width="700"><p class="caption">
<strong>Peak detection in sample file</strong>.
</p>
</div>
<details><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">peaks</span><span class="op">)</span> <span class="op">/</span> <span class="va">f</span><span class="op">@</span><span class="va">samp.rate</span>
<span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><pre><code>## 96.4(4)</code></pre>
<p>The same procedure was repeated with all the files:</p>
<details><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.glob.html">Sys.glob</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">PATH_WAVS</span>, <span class="st">"/*"</span><span class="op">)</span><span class="op">)</span>
<span class="va">mark</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">".wav"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">wav</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">bpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">wav</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/normalize.html">normalize</a></span><span class="op">(</span><span class="fu">tuneR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tuneR/man/readWave.html">readWave</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
  <span class="va">f</span><span class="op">@</span><span class="va">left</span><span class="op">[</span><span class="va">f</span><span class="op">@</span><span class="va">left</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_peaks.html">find_peaks</a></span><span class="op">(</span><span class="va">f</span><span class="op">@</span><span class="va">left</span>, <span class="va">f</span><span class="op">@</span><span class="va">samp.rate</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span>
  <span class="va">period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">peaks</span><span class="op">)</span> <span class="op">/</span> <span class="va">f</span><span class="op">@</span><span class="va">samp.rate</span>
  <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">period</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><p>All these measurements are included in the <code>metr.neewer</code> data set:</p>
<details><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">metr.neewer</span><span class="op">)</span></code></pre></div>
</details><pre><code>##   mark      bpm    bpm.se
## 1   40 37.65203 0.6741290
## 2   42 39.50508 0.6750543
## 3   44 41.97662 0.6010792
## 4   46 44.11887 0.5014112
## 5   48 45.99899 0.5032427
## 6   50 47.88837 0.5011762</code></pre>
</div>
<div id="model-accuracy" class="section level2">
<h2 class="hasAnchor">
<a href="#model-accuracy" class="anchor"></a>Model accuracy</h2>
<p>Then, the metronome was dismantled and all model parameters were measured (dimensions and masses). Our model achieves even better accuracy than the calibration set by the manufacturer (MAE of less than 2 bpm, compared to a MAE of 3 bpm for the metronome scale).</p>
<details><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># measurements for the masses</span>
<span class="co"># M &lt;- set_errors(30.8, 0.01)</span>
<span class="co"># mu &lt;- set_errors(3.8, 0.01)</span>

<span class="co"># correction for L = R, as for the rest of the metronomes</span>
<span class="va">metr.params</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">$</span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">metr.params</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">$</span><span class="va">R</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">31.01</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">7.1</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">3.59</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">M.</span> <span class="op">&lt;-</span> <span class="va">M</span> <span class="op">/</span> <span class="va">m</span>
<span class="va">mu.</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">/</span> <span class="va">m</span>

<span class="co"># gravitational acceleration</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">set_errors</a></span><span class="op">(</span><span class="fl">9.807</span>, <span class="fl">0.04</span><span class="op">)</span>

<span class="co"># attach rcm, l, R, L, A</span>
<span class="va">metr.params</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Neewer"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/errors.html">unite_errors</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">neewer</span> <span class="op">&lt;-</span> <span class="va">metr.marks</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Neewer"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">metr.neewer</span>, by<span class="op">=</span><span class="st">"mark"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/errors.html">unite_errors</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">comparative</span> <span class="op">&lt;-</span> <span class="va">neewer</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Model  <span class="op">=</span> <span class="fu"><a href="../reference/metr_model.html">metr_model</a></span><span class="op">(</span><span class="va">r</span><span class="op">+</span><span class="va">rcm</span>, <span class="va">R</span>, <span class="va">M.</span>, <span class="va">l</span>, <span class="va">L</span>, <span class="va">mu.</span>, <span class="va">g</span>, <span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Forsen <span class="op">=</span> <span class="fu"><a href="../reference/metr_model.html">metr_model</a></span><span class="op">(</span><span class="va">r</span><span class="op">+</span><span class="va">rcm</span>, <span class="va">R</span>, <span class="va">M.</span>, <span class="va">l</span>, <span class="va">L</span>, <span class="fl">0</span>,   <span class="va">g</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/errors.html">gather_errors</a></span><span class="op">(</span><span class="st">"series"</span>, <span class="st">"value"</span>, <span class="st">"Model"</span>, <span class="st">"Forsen"</span>, <span class="st">"bpm"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"Forsen"</span>, <span class="st">"Forsén et al. (2013)"</span>, <span class="va">series</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"bpm"</span>, <span class="st">"Experimental"</span>, <span class="va">series</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">series</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">comparative</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">mark</span>, <span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, color<span class="op">=</span><span class="va">series</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html">geom_rangeframe</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">bpm</span><span class="op">)</span><span class="op">)</span>, data<span class="op">=</span><span class="va">neewer</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope<span class="op">=</span><span class="fl">1</span>, color<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, ymax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"gam"</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Metronome mark [bpm]"</span>, y<span class="op">=</span><span class="st">"Oscillation frequency [bpm]"</span>, color<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
        axis.title.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, axis.title.x<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><div class="figure">
<img src="metr-model_files/figure-html/unnamed-chunk-7-1.png" alt="**Model validation**. The parametrization of a contemporary metronome is compared to its experimental oscillation frequency. It should be noted that the experimental results do not exactly follow the 1:1 relation (gray line), which means that the calibration of the scale has a small error, and our model accurately predicts it. The model by Forsén _et al._ (2013), which uses a double pendulum without corrections, is included for completeness." width="700"><p class="caption">
<strong>Model validation</strong>. The parametrization of a contemporary metronome is compared to its experimental oscillation frequency. It should be noted that the experimental results do not exactly follow the 1:1 relation (gray line), which means that the calibration of the scale has a small error, and our model accurately predicts it. The model by Forsén <em>et al.</em> (2013), which uses a double pendulum without corrections, is included for completeness.
</p>
</div>
</div>
<div id="effect-of-corrections" class="section level2">
<h2 class="hasAnchor">
<a href="#effect-of-corrections" class="anchor"></a>Effect of corrections</h2>
<p>The same contemporary metronome was used to study the effect of each kind of correction. To this end, the true mass of the rod, the true oscillation angle and the maximum friction allowed by the model (<span class="math inline">\(\epsilon = 0.5\)</span>) were separately compared against the null model (null mass, oscillation angle and friction) along the whole scale range.</p>
<details><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corrections</span> <span class="op">&lt;-</span> <span class="va">neewer</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>base     <span class="op">=</span> <span class="fu"><a href="../reference/metr_model.html">metr_model</a></span><span class="op">(</span><span class="va">r</span><span class="op">+</span><span class="va">rcm</span>, <span class="va">R</span>, <span class="va">M.</span>, <span class="va">l</span>, <span class="va">L</span>, <span class="fl">0</span>,   <span class="va">g</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Rod      <span class="op">=</span> <span class="fu"><a href="../reference/metr_model.html">metr_model</a></span><span class="op">(</span><span class="va">r</span><span class="op">+</span><span class="va">rcm</span>, <span class="va">R</span>, <span class="va">M.</span>, <span class="va">l</span>, <span class="va">L</span>, <span class="va">mu.</span>, <span class="va">g</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Angle    <span class="op">=</span> <span class="fu"><a href="../reference/metr_model.html">metr_model</a></span><span class="op">(</span><span class="va">r</span><span class="op">+</span><span class="va">rcm</span>, <span class="va">R</span>, <span class="va">M.</span>, <span class="va">l</span>, <span class="va">L</span>, <span class="fl">0</span>,   <span class="va">g</span>, <span class="va">A</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Friction <span class="op">=</span> <span class="fu"><a href="../reference/metr_model.html">metr_model</a></span><span class="op">(</span><span class="va">r</span><span class="op">+</span><span class="va">rcm</span>, <span class="va">R</span>, <span class="va">M.</span>, <span class="va">l</span>, <span class="va">L</span>, <span class="fl">0</span>,   <span class="va">g</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Rod      <span class="op">=</span> <span class="op">(</span><span class="va">Rod</span>      <span class="op">-</span> <span class="va">base</span><span class="op">)</span> <span class="op">/</span> <span class="va">base</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Angle    <span class="op">=</span> <span class="op">(</span><span class="va">Angle</span>    <span class="op">-</span> <span class="va">base</span><span class="op">)</span> <span class="op">/</span> <span class="va">base</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Friction <span class="op">=</span> <span class="op">(</span><span class="va">Friction</span> <span class="op">-</span> <span class="va">base</span><span class="op">)</span> <span class="op">/</span> <span class="va">base</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/errors.html">gather_errors</a></span><span class="op">(</span><span class="st">"series"</span>, <span class="st">"value"</span>, <span class="st">"Rod"</span>, <span class="st">"Angle"</span>, <span class="st">"Friction"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>series <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">series</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Friction"</span>, <span class="st">"Angle"</span>, <span class="st">"Rod"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">corrections</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">mark</span>, <span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, color<span class="op">=</span><span class="va">series</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html">geom_rangeframe</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_min</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, ymax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"gam"</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Metronome mark [bpm]"</span>, y<span class="op">=</span><span class="st">"Correction [%]"</span>, color<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.98</span>, <span class="fl">0.58</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><div class="figure">
<img src="metr-model_files/figure-html/unnamed-chunk-8-1.png" alt="**Effect of corrections** throughout the whole range for the same metronome, expressed as a percentage over the null model (frictionless, small-angle approximation for a massless rod) for each metronome mark." width="700"><p class="caption">
<strong>Effect of corrections</strong> throughout the whole range for the same metronome, expressed as a percentage over the null model (frictionless, small-angle approximation for a massless rod) for each metronome mark.
</p>
</div>
<p>As expected, considering the mass of the rod contributes the most to the model accuracy, and thanks to the escapement wheel, the effect of friction is negligible except for the lowest oscillation frequencies.</p>
</div>
</div>
<div id="model-transformation-and-fit" class="section level1">
<h1 class="hasAnchor">
<a href="#model-transformation-and-fit" class="anchor"></a>Model transformation and fit</h1>
<p>Neglecting the effect of friction (<span class="math inline">\(f_\mathrm{fric} \approx 1\)</span>), we express <span class="math inline">\(\Omega^2\)</span> as a linear combination of polynomial terms of <span class="math inline">\(r\)</span>:</p>
<p><span class="math display">\[
\Omega^2=a_0 + b_2 \left(\frac{g}{f_\mathrm{ang}^2(\theta)}  r + \Omega^2 r^2 \right)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
a_0= \frac{g}{f_\mathrm{ang}^2(\theta)} \cdot \frac{M'R-\frac{\mu'}{2}(l-L)}{M'R^2+\frac{\mu'}{3}(L^2+l^2-lL)} \\
b_2= -\frac{1}{M'R^2+\frac{\mu'}{3}(L^2+l^2-lL)}
\]</span></p>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<p>This linear model was fitted for two old metronomes from dates similar to Beethoven’s metronome, the patent diagram, and the contemporary metronome as a control (see first figure).</p>
<details><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metr</span> <span class="op">&lt;-</span> <span class="va">metr.marks</span>
<span class="va">metr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"Neewer"</span>, <span class="va">metr</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>,<span class="op">]</span><span class="op">$</span><span class="va">mark</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">metr.neewer</span><span class="op">$</span><span class="va">bpm</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">metr</span> <span class="op">&lt;-</span> <span class="va">metr</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metr_fit.html">metr_fit</a></span><span class="op">(</span><span class="va">metr</span>, <span class="va">metr.params</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/errors.html">unite_errors</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"Neewer"</span>, <span class="st">"Control"</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metr_fit.html">metr_predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">metr</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/errors.html">unite_errors</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"Neewer"</span>, <span class="st">"Control"</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">r.squared</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">fit</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span><span class="op">)</span>
<span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu">.</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="st">","</span> <span class="op">~</span> <span class="va">R</span><span class="op">^</span><span class="fl">2</span><span class="op">==</span><span class="fu">.</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">pred</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">r.squared</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="va">y</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">model</span>, <span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="va">min</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html">geom_rangeframe</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lwr</span>, ymax<span class="op">=</span><span class="va">upr</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">.2</span>, size<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html">geom_errorbarh</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_min</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_max</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>, height<span class="op">=</span><span class="fl">2</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">fit</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_hue.html">scale_color_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="va">labels</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"r [mm]"</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Omega</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, color<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><div class="figure">
<img src="metr-model_files/figure-html/unnamed-chunk-9-1.png" alt="**Model fit** for the oscillation frequency squared as a function of the position of the moving weight." width="700"><p class="caption">
<strong>Model fit</strong> for the oscillation frequency squared as a function of the position of the moving weight.
</p>
</div>
<p>Metronome dimensions were measured using Fiji on the basis of the total heights reported in Tony Bingham’s catalogue. The total height is assumed to be 31 cm for the patent according to the patent description and the height of the oldest metronome. The oscillation angle is taken as the maximum inclination, bounded by the box. Parameter R cannot be directly measured for some metronomes (when the box hides the lower mass), so it was estimated taking into account the box size and the patent description. Given that the lower mass hangs approximately from the end of the rod, it is assumed that <span class="math inline">\(L \approx R\)</span>. With these assumptions, we estimated the nondimensional masses, <span class="math inline">\(M'\)</span> and <span class="math inline">\(μ'\)</span>, for each metronome from the regression coefficients.</p>
<details><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">note</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>model<span class="op">=</span><span class="st">"Control (true)"</span>, M.<span class="op">=</span><span class="va">M.</span>, mu.<span class="op">=</span><span class="va">mu.</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">M.</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">mu.</span><span class="op">)</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">model</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/drop_errors.html">drop_errors</a></span><span class="op">(</span><span class="va">mu.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/geom_rangeframe.html">geom_rangeframe</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">.7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>shape<span class="op">=</span><span class="va">model</span><span class="op">)</span>, data<span class="op">=</span><span class="va">note</span>, color<span class="op">=</span><span class="st">"black"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html">geom_errorbarh</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_min</a></span><span class="op">(</span><span class="va">M.</span><span class="op">)</span>, xmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_max</a></span><span class="op">(</span><span class="va">M.</span><span class="op">)</span><span class="op">)</span>, height<span class="op">=</span><span class="fl">.005</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_min</a></span><span class="op">(</span><span class="va">mu.</span><span class="op">)</span>, ymax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/errors/man/errors.html">errors_max</a></span><span class="op">(</span><span class="va">mu.</span><span class="op">)</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">.012</span>, size<span class="op">=</span><span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="cn">NULL</span>, values<span class="op">=</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Nondimensionalized lower mass"</span>, y<span class="op">=</span><span class="st">"Nondimensionalized rod mass"</span>, color<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>order<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, shape<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>order<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.95</span>, <span class="fl">.95</span><span class="op">)</span>, legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, legend.spacing.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</details><div class="figure">
<img src="metr-model_files/figure-html/unnamed-chunk-10-1.png" alt="**Parameter estimation for all the metronomes considered**. Estimation of nondimensionalized masses $\mu'$ (rod) and $M'$ (lower mass). Both controls (measuring a dismantled metronome with precision as well as measuring all the distances from a photograph) accurately estimate the true masses for the contemporary metronome, thus validating the estimation for the rest of the metronomes." width="700"><p class="caption">
<strong>Parameter estimation for all the metronomes considered</strong>. Estimation of nondimensionalized masses <span class="math inline">\(\mu'\)</span> (rod) and <span class="math inline">\(M'\)</span> (lower mass). Both controls (measuring a dismantled metronome with precision as well as measuring all the distances from a photograph) accurately estimate the true masses for the contemporary metronome, thus validating the estimation for the rest of the metronomes.
</p>
</div>
</div>
<div id="beethovens-metronome" class="section level2">
<h2 class="hasAnchor">
<a href="#beethovens-metronome" class="anchor"></a>Beethoven’s metronome</h2>
<p>Results show that this methodology accurately estimates the masses for the control metronome, and thus, we take the averages of the old metronomes and the patent as a parametrization of Beethoven’s metronome, with the rest of the parameters equal to the measurements for the patent.</p>
<details><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">fit</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="va">res</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>
<span class="va">res</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Beethoven's metronome (average)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">M.</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">mu.</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">res</span>, caption<span class="op">=</span><span class="va">table1</span><span class="op">)</span></code></pre></div>
</details><table class="table">
<caption>
<strong>Beethoven’s metronome estimate</strong>, as the average of the estimates for the TB 06, TB 07 metronomes and the patent.</caption>
<thead><tr class="header">
<th align="left">model</th>
<th align="right">M.</th>
<th align="right">mu.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Patent</td>
<td align="right">4.1(1)</td>
<td align="right">0.63(2)</td>
</tr>
<tr class="even">
<td align="left">TB 06</td>
<td align="right">3.9(1)</td>
<td align="right">0.66(3)</td>
</tr>
<tr class="odd">
<td align="left">TB 07</td>
<td align="right">4.1(1)</td>
<td align="right">0.63(3)</td>
</tr>
<tr class="even">
<td align="left">Beethoven’s metronome (average)</td>
<td align="right">4.0(1)</td>
<td align="right">0.64(3)</td>
</tr>
</tbody>
</table>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Almudena Martín-Castro, Iñaki Ucar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
